## MySQL前置知识和概念
### 数据库和数据库实例
- 数据库：文件的集合，依照某种数据模型组织起来并存放于二级存储器中的数据集合。
- 数据库实例：是程序，是位于用户与操作系统之间的一层数据通用软件，用户对数据库的任何操作，都是在数据库实例下进行的。

### Note
- 存储引擎是基于表的，而不是数据库
- MySQL数据库区别与其他数据库的重要的特点是其插件式的表存储引擎

## InnoDB 存储引擎
主要由两块组成：
- 后台线程：
    - Master Thread 缓存池中的数据异步的刷新到磁盘
    - IO Thread 负责I/O的请求回调，write,read,insert buffer,log I/O thread
    - Purge Thread 事务被提交后 undo log不再需要
    - Page Cleaner Thread 脏页的刷新操作

        #### undo和redo区别
        undo 存放数据被修改前的值
        redo 脏页未刷新到磁盘，发生crash
- 内存
    - 缓冲池 存放不同类型的页 InnoDB存储引擎是基于磁盘存储的，并将其中的记录按照页的方式进行管理，所以类似操作系统中的用户进程空间，也需要虚拟内存来管理

        #### checkpoint技术 p32页
        解决的问题：
        - 1.缩短数据库的恢复时间
        - 2.缓冲池不够用时，将脏页刷新到磁盘
        - 3.重做日志不可用时，刷新脏页

## 表
我的理解表就是数据库用来存放数据的一套存储结构的抽象。

在innodb中，表都是根据主键顺序组织存放的，这种存放方式的表称为**索引组织表**

这一套存储结构由5个模块组合成 **行--页--区--段--表空间** 。

#### 表空间
- 共享表空间：指的是数据库的所有的表数据，索引文件全部放在一个文件中，默认这个共享表空间的文件路径在 data 目录下。

- 独立表空间(单独表空间)：每一个表都将会生成以独立的文件方式来进行存储。 优点：当表被删除时这部分空间可以被回收；可以更快的恢复和备份单个表；将单个表复制到另一个实例会很方便； 缺点：mysqld会维持很多文件句柄，表太多会影响性能。如果很多表都增长会导致碎片问题


## 索引
三种基本的索引
- B+树 (高扇出性，树高一般都在2-4层)
    - 聚集索引：按每张表的主键构造一棵B+树，同时叶子节点中存放的即为整张表的行记录数据，也将聚集索引的叶子节点称为数据页。聚集索引的这个特性决定了索引组织表中数据页是索引的一部分。每个数据页通过双向链表来进行链接。
- 哈希 (等值查询的，无序的)
- 全文检索 

## 锁

## 记笔记：4.4.5(Page Directory)
B+树索引本身并不能找到具体的一条记录，